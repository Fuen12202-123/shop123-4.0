@model IEnumerable<shop123.Models.ordersDetail>


@{
    ViewBag.Title = "ShoppingCar";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<style>
    .table th, .table td {
        text-align: center;
        vertical-align: middle;
    }
</style>
@*<link href="~/Content/shopcartstyle.css" rel="stylesheet" />*@

<table class="table ">
    <thead><tr><th>@*<input type="checkbox" id="CheckAll" name="CheckAll" />*@</th><th>商品</th><th></th><th>單價</th><th>數量</th><th>總計</th><th>操作</th></tr> </thead>

    <tbody>
        @{ int TotalPrice = 0;}
        @foreach (var item in Model)
        {
            int itemSubtotal = 0;
            
        <tr>
            @if (@item.@checked == true)
            {
                <td><input onclick="skuchecked(@item.skuId)" type="checkbox" name="checkboxs" value="" id="sku" checked /></td>
                itemSubtotal = item.orderDetailprice.Value * item.orderDetailnum.Value;
                TotalPrice += itemSubtotal;
            }
            else
            {
                <td><input onclick="skuchecked(@item.skuId)" type="checkbox" name="checkboxs" value="" id="sku" /></td>
            }

            <td><a href="@Url.Action("Detail","Home")?id=@item.spuId" )"><img src="@Url.Content($"{item.spuImg1}")" style="width:100px;height:100px" class="img-responsive"></a></td>
            <td>
                <a class="text-dark  text-decoration-none" href="@Url.Action("Detail","Home")?id=@item.spuId" )">
                    @item.orderDetailspuname-
                    @item.orderDetailcolor-
                    @item.orderDetailsize
                </a>
            </td>

            <td>@($"{item.orderDetailprice:c0}")</td>

            <td>
                @using (Html.BeginForm("EditCount", "Member", FormMethod.Post))
                {
                      
                        @Html.Hidden("ProductID", item.skuId)
                        @Html.TextBox("ProductCount", item.orderDetailnum, new { @class = "form -control", style = "width:35px"})
                        <input type="submit" value="變更"/>
                    
                   
                }

            </td>

            <td>@($"{ itemSubtotal:c0}")</td>
            @*<td>@Html.ActionLink("刪除", "DeleteCar", "Member", new { Id = item.skuId }, new { @class = "btn btn-danger" })</td>*@
            <td>
                <a href="@Url.Action("DeleteCar")?Id=@item.id"
                   class="btn " *@><i class="fa-solid fa-trash-can"></i></a>
            </td>
        </tr>



        }

    </tbody>
    
    
</table>

@*<div class="d-flex justify-content-end mr-4"><h5>總金額： @($"{TotalPrice:c0}")   | @Html.ActionLink(" ", "checkout", "Member", null, new { @class = "btn btn-info" })<i class="fa-solid fa-check"></i></h5></div>*@
<div class="d-flex justify-content-end mr-2"><h5>總金額： @($"{TotalPrice:c0}")   | <a href="@Url.Action("checkout")" class="btn"><i class="fa-solid fa-circle-check" style="font-size:2rem"></i></a>
</h5></div>

@*function DeleteCar(Id) {
    $.ajax({
        type: 'POST',
        url: '@Url.Action("DeleteCar", "Member")',
        data: { Id: Id }
        })

        }*@


<script>
    $(document).ready(function () {
    })

    //function minus() {
    //    $('.count').val(parseInt($('.count').val()) - 1);
    //    if ($('.count').val() == 0) {
    //        $('.count').val(1);
    //    }
    //}

    //function plus() {
    //    $('.count').val(parseInt($('.count').val()) +1);
    //}



    function skuchecked(skuid) {
        $.ajax({
            type: 'POST',
            url: '@Url.Action("skuchecked", "Member")',
            data: { skuid: skuid }
        })
    }

</script>



